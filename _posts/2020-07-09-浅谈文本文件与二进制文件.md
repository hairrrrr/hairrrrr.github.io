---
title: 浅谈文本文件与二进制文件
tags: 计算机基础
---





在学习 C 语言时，我们知道：

### 二 C 与 C++ 对文本文件和二进制文件的操作

#### 1. NotePad++ 的 HexEditor 插件

使用 NotePad++ 的 HexEditor 插件可以在文件中看到数据编码前的格式。



#### 2. C 

##### 文本文件

```c
void test6pp()
{
	FILE* fp = fopen("text.c.txt", "w+");

	struct Student s = { "Shepard Wang", 20, "man" };

	fprintf(fp, "%s%d%s", s.name, s.age, s.gender);
}
```

我们打开`text.c.txt`文件，看到：

![](https://hairrrrr.github.io/assets/2020-07-09-1.png)

写入文件成功，我们再来试试读取：

```c
void test6pp()
{
	FILE* fp = fopen("text.c.txt", "w+");

	struct Student s = { "Shepard Wang", 20, "man" };

	fprintf(fp, "%s%d%s", s.name, s.age, s.gender);

	fclose(fp);

    // 读取
	FILE* fp2 = fopen("text.c.txt", "r");

	struct Student s2;
	
	// 读取出现错误
	// s2.name 是 Shepard，遇到空格结束读取
	fscanf(fp2, "%s%d%s", s2.name, &s2.age, s2.gender);

	fclose(fp2);
}
```

取消姓名中的空格：

```c
struct Student s = { "ShepardWang", 20, "man" };
```

再试试？发现 s2.name 把所有数据都读完了，因此，在写文件时，最好给不同的数据项之间加上空格或换行：

```c
fprintf(fp, "%s %d %s", s.name, s.age, s.gender);
```

这下就可以正确的读取了。

##### 二进制文件

```c
void test6ppp()
{
	FILE* fp = fopen("binary.c.txt", "w+");

	struct Student s = { "ShepardWang", 20, "man" };

	fwrite(&s, sizeof(s), 1, fp);

	fclose(fp);
}
```

![](https://hairrrrr.github.io/assets/2020-07-09-2.png)

注意一下文本文件和二进制文件中 20 的存储格式：

![](https://hairrrrr.github.io/assets/2020-07-09-3.png)

就像上面 **一**  中说的那样。

读取二进制文件：

```c
void test6ppp()
{
	FILE* fp = fopen("binary.c.txt", "w+");

	struct Student s = { "ShepardWang", 20, "man" };

	fwrite(&s, sizeof(s), 1, fp);

	fclose(fp);

	FILE* fp2 = fopen("binary.c.txt", "r");

	struct Student s2;

	fread(&s2, sizeof(s2), 1, fp2);

	fclose(fp2);
}
```

我们可以二进制文件可以整块的读取，效率高（而且不用操心空格换行



#### 3. C++

##### 文本文件

```cpp
void test6p()
{
	// 文本格式写文件
	ofstream text("text.cpp.txt");
	
	struct Student s = { "Shepard_Wang", 20, "man" };

	text << s.name << " " << s.age << " " << s.gender << endl;

	text.close();

	ifstream text2("text.cpp.txt");
	
	struct Student s2;

	text2 >> s2.name >> s2.age >> s2.gender;

	text2.close();
}
```

##### 二进制文件

```cpp
void test6cpppp()
{
	ofstream text("binary.cpp.txt");

	struct Student s = { "Shepard_Wang", 20, "man" };

	text.write((char*)&s, sizeof(s));

	text.close();

	ifstream text2("binary.cpp.txt");

	struct Student s2;

	text2.read((char*)&s2, sizeof(s2));

	text2.close();
}
```



### 三  思考

#### 1. 能否用 read 读取文本文件？或者用 >> 读取二进制文件？

对应的 C 语言的问题就是 “能否用 fscanf 读取二进制文件？能否用 fread 读取文本文件？”

文本文件和二进制文件的存储方式不同：

文本文件是按照字符存储，数据项用空字符隔开；而二进制文件是按照字节存储。

如果混用，肯定会造成混乱。